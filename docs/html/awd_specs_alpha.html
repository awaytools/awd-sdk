<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>cpp-libawd: AWD 3.0 Specifications alpha</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo_AwayTools_300x300.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">cpp-libawd
   </div>
   <div id="projectbrief">cpp-library to convert and prepare AWD-data</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('awd_specs_alpha.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title"><a class="el" href="namespace_a_w_d.html" title="The namespace used for the complete libawd. ">AWD</a> 3.0 Specifications alpha </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>AWD3 Specification</h1>
<p>This document descipes the specifications for <a class="el" href="namespace_a_w_d.html" title="The namespace used for the complete libawd. ">AWD</a> 3.0 as used in AwayJS November 2014 - January 2015.</p>
<p>The final specs for AWD3.0 are currently under development, and will be part of the updated specifications for <a class="el" href="namespace_a_w_d.html" title="The namespace used for the complete libawd. ">AWD</a> (<a class="el" href="awd_specs.html">AWD 3.0 Specifications</a>)</p>
<p>AWD3 extends the AWD2 Format to support 2D-Shape data for a new AwayJS shape animation runtime.</p>
<p>The first software to support creation of AWD3 data will be FlashProfessional CC 2014(build 14.1.0.30 and later)</p>
<h2>Basic Structure of <a class="el" href="namespace_a_w_d.html" title="The namespace used for the complete libawd. ">AWD</a></h2>
<p>An AWD-file contains one AWD-Header <a class="el" href="awd_specs_2.html#awd_pt2_file_header">File header</a>, and a list of AWDBlocks.</p>
<p>All AWD-Blocks have the same Header</p>
<table class="doxtable">
<tr>
<th>Offset </th><th>Size </th><th>Type </th><th>Description  </th></tr>
<tr>
<td>0 </td><td>4 </td><td>BlockAddr (uint32) </td><td>BlockID </td></tr>
<tr>
<td>4 </td><td>1 </td><td>uint8 </td><td>Block Namespace Handle </td></tr>
<tr>
<td>5 </td><td>1 </td><td>uint8 </td><td>Block Type </td></tr>
<tr>
<td>6 </td><td>1 </td><td>uint8 </td><td>Flags </td></tr>
<tr>
<td>7 </td><td>4 </td><td>uint32 </td><td>Block Data size in bytes </td></tr>
</table>
<p><a class="el" href="awd_specs_2.html#awd_pt2_9_1">Block Header</a></p>
<p>The BlockID is used to link blocks to each other (assign material to mesh etc).</p>
<p>This gives the restriction that a referenced block must occur in the AWD-file before the block that is referencing it.</p>
<p>In <a class="el" href="namespace_a_w_d.html" title="The namespace used for the complete libawd. ">AWD</a> we have storage-precision (header-flags define if to read numbers as float32 or float64). For now this specs do not take this into account. E.g. Wherever the datatype float32 is used, it could also be float64. For now, the FlashExporter will always use float32 for encoding numbers.</p>
<h2>AWD3 Block-types</h2>
<p>To support all the needed 2D shape data, we will need these blocks to be added to <a class="el" href="namespace_a_w_d.html" title="The namespace used for the complete libawd. ">AWD</a>:</p>
<table class="doxtable">
<tr>
<th>Type ID </th><th>Block Type </th><th>AssetType  </th></tr>
<tr>
<td>82 </td><td>Texture </td><td>TEXTURE </td></tr>
<tr>
<td>131 </td><td>Geometry2D </td><td>GEOMETRY_2D </td></tr>
<tr>
<td>132 </td><td>Fill </td><td>FILL </td></tr>
<tr>
<td>133 </td><td>TimeLine </td><td>TIMELINE </td></tr>
<tr>
<td>141 </td><td>Sound </td><td>SOUND </td></tr>
<tr>
<td>134 </td><td>Textelement </td><td>TEXT_ELEMENT </td></tr>
<tr>
<td>135 </td><td>FontTable </td><td>FONT_TABLE </td></tr>
</table>
<blockquote class="doxtable">
<p><b>Changes for final specs:</b><br />
 In the final specifiactions for AWD3.0 it will not be neccessary to differ between Geometry2D (id = 131) and TriangleGeometry (id = 1).<br />
 We can use the Triangle-Geometry-Block (id=1) to store Subgeometries that contain streams for 3d-data, and streams for 2d-data.<br />
 The same applies for the Fill-block (id = 132). We can use the Material-Block for this(id = 81).<br />
</p>
</blockquote>
<h3>Texture</h3>
<p>Already in AWD2. </p><blockquote class="doxtable">
<p><a class="el" href="awd_specs_2.html#awd_pt2_13_2">BitmapTexture block (ID 82)</a> </p>
</blockquote>
<p>A texture in AWD2 can be either external (URL) or embed (byte-data).</p>
<p>AWDParser will not parse the texture data, but hand it over to the parsing system, and wait until the paring system has finished loading/parsing the texture.</p>
<h3>Geometry2D</h3>
<blockquote class="doxtable">
<p><b>Changes for final specs:</b><br />
 In the final specifications, this should be merged into TriangleGeometry-block. <br />
 See <a class="el" href="awd_specs_2.html#awd_pt2_11_1">TriangleGeometry (ID 1)</a> for more information.<br />
</p>
</blockquote>
<p>This block holds all the shape-data.</p>
<p>Strokes are also converted to shapes (on export).</p>
<p>The structure of Geometry2D is exactly the same as the TriangleGeometry in AWD2. _(AWD2Specs/Part II:File format specifiation//The Data Block concept/Geometry blocks/TriangleGeometry)_</p>
<table class="doxtable">
<tr>
<th>Offset </th><th>Size </th><th>Type </th><th>Description  </th></tr>
<tr>
<td>0 </td><td>11 </td><td>Blockheader </td><td>&mdash; </td></tr>
<tr>
<td>11 </td><td>variable </td><td>varString </td><td>The name of the shape. FlashPro does not give us any shape-names, but in future we might have editors that asign names to shapes. </td></tr>
<tr>
<td>variable </td><td>2 </td><td>uint16 </td><td>Number of SubGeometry2D </td></tr>
<tr>
<td>variable </td><td>variable </td><td>NumAttrList </td><td>Geometry2D properties </td></tr>
<tr>
<td>variable </td><td>variable </td><td>List of SubGeometry2D </td><td>SubGeometry2Ds </td></tr>
<tr>
<td>variable </td><td>variable </td><td>UserAttrList </td><td>User Atrributes </td></tr>
</table>
<p>In <a class="el" href="namespace_a_w_d.html" title="The namespace used for the complete libawd. ">AWD</a>, the only difference between a SubGeometry and a SubGeometry2D is in the type of streams they are using.</p>
<p>The Ids of the SubGeometry2D streams:</p>
<table class="doxtable">
<tr>
<th>ID </th><th>Stream  </th></tr>
<tr>
<td>1 </td><td>Face indices no aliased edges </td></tr>
<tr>
<td>2 </td><td>Face indices one aliased edge </td></tr>
<tr>
<td>3 </td><td>Face indices convex </td></tr>
<tr>
<td>4 </td><td>Face indices concave </td></tr>
<tr>
<td>5 </td><td>Vertex positions </td></tr>
</table>
<p>I think we can get rid of the 4 different face-streams, because we define the Face-type as vertex-attribute. (?)</p>
<p>On Export, it is taken care, that non-curved-faces are allowed to share verticles, while curve faces all have their own unique verticle provided.</p>
<p>The spec for the vertex-data stream is work in progress.</p>
<p>At the moment float32 is used for all numbers, but we can enable storage-precision on this</p>
<p>The temp vertex-data that is saved at the moment:</p>
<table class="doxtable">
<tr>
<th>name </th><th>type  </th></tr>
<tr>
<td>position </td><td>3 x float32 </td></tr>
<tr>
<td>curve-type </td><td>float32 </td></tr>
<tr>
<td>unused</td><td>2 x float32 </td></tr>
<tr>
<td>curve.u </td><td>float32 </td></tr>
<tr>
<td>curve.v </td><td>float32 </td></tr>
<tr>
<td>red </td><td>float32 </td></tr>
<tr>
<td>green </td><td>float32 </td></tr>
<tr>
<td>blue </td><td>float32 </td></tr>
<tr>
<td>alpha </td><td>float32 </td></tr>
</table>
<p>final specs might look like this:</p>
<table class="doxtable">
<tr>
<th>name </th><th>type  </th></tr>
<tr>
<td>position </td><td>2 x float32 </td></tr>
<tr>
<td>curve-type </td><td>float32 </td></tr>
<tr>
<td>curve.u </td><td>float32 </td></tr>
<tr>
<td>curve.v </td><td>float32 </td></tr>
</table>
<p>Each SubGeometry2D can have a property for the UV-Transformation.</p>
<p>This is a Matrix3x2 (TransformMatrix).</p>
<p>If this is ommited, a Identiy Matrix will be used (If needed).</p>
<h3>Fill</h3>
<blockquote class="doxtable">
<p><b>Changes for final specs:</b><br />
 In the final specifications, this should be merged into Material-block.<br />
 See <a class="el" href="awd_specs_2.html#awd_pt2_13_1">Material block (ID 81)</a> for more information.<br />
</p>
</blockquote>
<p>Fill stores information about color / texture / gradients.</p>
<p>The Timeline-block will connect a shape to a fill (and put it on the "stage").</p>
<p>Also the timeLine-block will apply filters and colorTranforms etc to objects, so no need to store them in fill (not like AWD2 Material methods)</p>
<p>This is pretty much like a <a class="el" href="namespace_a_w_d.html" title="The namespace used for the complete libawd. ">AWD</a> Material block. _(AWD2Specs/Part II:File format specifiation//The Data Block concept/Material blocks/Simple Material block)_</p>
<p>For all fills, the texture-atlas stuff is prepared, but not yet finished implemented / exported.</p>
<table class="doxtable">
<tr>
<th>Offset </th><th>Size </th><th>Type </th><th>Description  </th></tr>
<tr>
<td>0 </td><td>11 </td><td>BlockHeader </td><td>&mdash; </td></tr>
<tr>
<td>11 </td><td>variable </td><td>varString </td><td>The name of the fill. FlashPro does not give us any fill-names, but in future we might have editors that asign names to shapes. </td></tr>
<tr>
<td>variable </td><td>1 </td><td>uint8 </td><td>Fill-Type </td></tr>
<tr>
<td>variable </td><td>variable </td><td>fill-properties-block</td><td>content varies with fill-type </td></tr>
<tr>
<td>variable </td><td>variable </td><td>NumAttrList </td><td>User Attributes </td></tr>
<tr>
<td>variable </td><td>variable </td><td>UserAttrList </td><td>User Attributes </td></tr>
</table>
<h4>Fill Types</h4>
<table class="doxtable">
<tr>
<th>ID </th><th>Fill Type  </th></tr>
<tr>
<td>1 </td><td>Solid Fill </td></tr>
<tr>
<td>2 </td><td>Textured </td></tr>
<tr>
<td>3 </td><td>Linear gradient </td></tr>
<tr>
<td>4 </td><td>Radial gradient </td></tr>
</table>
<h5>Solid Fill</h5>
<table class="doxtable">
<tr>
<th>Offset </th><th>Size </th><th>Type </th><th>Description </th><th>Default  </th></tr>
<tr>
<td>0 </td><td>4</td><td>color </td><td>color - used as long as textureAtlas is not working </td><td>0xffffff </td></tr>
<tr>
<td>4 </td><td>4 </td><td>BlockAddr </td><td>TextureID(AWD ID of texture)</td><td>0 </td></tr>
<tr>
<td>8 </td><td>8</td><td>List of 2 x float32</td><td>TextureAtlas Position - uv.u uv.v - All in percent of total texture (0.0-1.0) </td><td>0.5,0.5 </td></tr>
</table>
<h5>Textured Fill</h5>
<table class="doxtable">
<tr>
<th>Offset </th><th>Size </th><th>Type </th><th>Description </th><th>Default  </th></tr>
<tr>
<td>0 </td><td>4 </td><td>BlockAddr </td><td>TextureID (<a class="el" href="namespace_a_w_d.html" title="The namespace used for the complete libawd. ">AWD</a> ID of texture)</td><td>0 </td></tr>
<tr>
<td>4 </td><td>16 </td><td>List of 4 x float32</td><td>TextureAtlas Position - StartX, StartY, EndX, EndY - All in percent of total texture (0.0-100.0) </td><td>0,0,100,100 </td></tr>
</table>
<h5>Linear gradient Fill</h5>
<table class="doxtable">
<tr>
<th>Offset </th><th>Size </th><th>Type </th><th>Description </th><th>Default  </th></tr>
<tr>
<td>0 </td><td>4</td><td>BlockAddr </td><td>TextureID (<a class="el" href="namespace_a_w_d.html" title="The namespace used for the complete libawd. ">AWD</a> ID of texture)</td><td>0 </td></tr>
<tr>
<td>4 </td><td>1</td><td>awd_uint8 </td><td>Number of gradients - restricted to max 255</td><td>0 </td></tr>
</table>
<p>5 |variable|list of gradient|list of gradients</p>
<h5>Radial gradient Fill</h5>
<table class="doxtable">
<tr>
<th>Offset </th><th>Size </th><th>Type </th><th>Description </th><th>Default  </th></tr>
<tr>
<td>0 </td><td>4</td><td>BlockAddr </td><td>TextureID (<a class="el" href="namespace_a_w_d.html" title="The namespace used for the complete libawd. ">AWD</a> ID of texture)</td><td>0 </td></tr>
<tr>
<td>4 </td><td>1</td><td>awd_uint8 </td><td>Number of gradients - restricted to max 255</td><td>0 </td></tr>
</table>
<p>5 |variable|list of gradient|list of gradients</p>
<h6>Gradient</h6>
<p>One gradient is the gradient between 2 colors. we only need one value (to map to the corresponding row in the textureAtlas).</p>
<table class="doxtable">
<tr>
<th>Offset </th><th>Size </th><th>Type </th><th>Description </th><th>Default  </th></tr>
<tr>
<td>0</td><td>1</td><td>uint16</td><td>the row of the gradient in the textureAtlas (0-511) </td><td>0 </td></tr>
</table>
<h3>TimeLine</h3>
<blockquote class="doxtable">
<p><b>Changes for final specs:</b><br />
 For the final implementation i suggest one change to the specification of timeline.<br />
 At the moment, a timeline can only be finalilized on import, after all frames of all timelines are completly parsed.<br />
 I would suggest that we allow Timelines to be merged on import, so that we can load a Movielclips first frame and display this.<br />
 All the other frames would than be stored in another timeline, that can be merged into the "only-first-frame" timeline after parsing.<br />
 This would allow to finalize a movieclip, before all frames of all childrens are parsed.<br />
</p>
</blockquote>
<p>Specifications for Timeline can be found here: <a class="el" href="awd_specs_2.html#awd_pt2_14_7">TimeLine</a><br />
</p>
<h3>Sound</h3>
<p>The structure of the Sound-Block is the same as the structure of the texture-Block. They only differ in their Block-ID, and in the type of properties they can have in their properties-list.</p>
<blockquote class="doxtable">
<p><a class="el" href="awd_specs_2.html#awd_pt2_15">Sound Blocks</a> </p>
</blockquote>
<p>As with textures, the sound can be present in the file as embed data, or as URL. In either way, the parser will stop parsing the current <a class="el" href="namespace_a_w_d.html" title="The namespace used for the complete libawd. ">AWD</a>, hand the sound-data over to the Parsing-system, and wait until processing has finished.</p>
<h5>Sound-properties</h5>
<table class="doxtable">
<tr>
<th>ID </th><th>Size </th><th>Type </th><th>Name </th><th>Description  </th></tr>
<tr>
<td>TODO</td><td>TODO</td><td>TODO</td><td>TODO</td><td>TODO </td></tr>
</table>
<h3>FontTable</h3>
<blockquote class="doxtable">
<p>Font and font-table havnt yet been exported into <a class="el" href="namespace_a_w_d.html" title="The namespace used for the complete libawd. ">AWD</a> files, the specs for this can be found here:<br />
 <a class="el" href="awd_specs_2.html#awd_pt2_16">Text BLocks</a></p>
</blockquote>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">Documentation</a></li>
    <li class="footer">Generated on Mon Feb 2 2015 18:04:26 for cpp-libawd by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.8 </li>
  </ul>
</div>
</body>
</html>
